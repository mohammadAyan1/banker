import{j as d}from"./index-w41rB-zE.js";import{x as s}from"./xlsx.min-CNgOfykx.js";const _=({data:i,name:p,tableId:m})=>{const f=()=>{const h=document.getElementById(m);if(!h){alert("Report Table Not Found");return}const t=s.utils.table_to_sheet(h,{raw:!0}),l=s.utils.decode_range(t["!ref"]||"A1:A1"),u=[],b=1;for(let e=l.s.c;e<=l.e.c;++e){let o=10;const r=t[s.utils.encode_cell({r:b,c:e})];r&&r.v&&(o=Math.max(o,r.v.toString().length));for(let c=l.s.r;c<=l.e.r;++c){const a=s.utils.encode_cell({r:c,c:e}),g=t[a];if(g&&g.v!=null){const y=g.v.toString().length;o=Math.max(o,y)}}u.push({wch:Math.min(o+4,50)})}t["!cols"]=u;for(let e=l.s.r;e<=l.e.r;++e)for(let o=l.s.c;o<=l.e.c;++o){const r=s.utils.encode_cell({r:e,c:o});t[r]||(t[r]={t:"s",v:""});const c=t[r];c.s=c.s||{},c.s.border={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},c.s.alignment={vertical:"center",horizontal:"center",wrapText:!0}}t.A1&&(t.A1.s={font:{bold:!0,sz:18,color:{rgb:"000000"}},fill:{fgColor:{rgb:"FFF9E79F"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"medium",color:{rgb:"000000"}},bottom:{style:"medium",color:{rgb:"000000"}},left:{style:"medium",color:{rgb:"000000"}},right:{style:"medium",color:{rgb:"000000"}}}});for(let e=l.s.c;e<=l.e.c;++e){const o=s.utils.encode_cell({r:b,c:e}),r=t[o];r&&(r.s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"FFD9E1F2"}},alignment:{horizontal:"center",vertical:"center",wrapText:!0},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}t["!merges"]&&t["!merges"].forEach(e=>{for(let o=e.s.r;o<=e.e.r;++o)for(let r=e.s.c;r<=e.e.c;++r){const c=s.utils.encode_cell({r:o,c:r});t[c]||(t[c]={t:"s",v:""});const a=t[c];a.s=a.s||{},a.s.border={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},a.s.alignment={vertical:"center",horizontal:"center",wrapText:!0}}}),t["!pageSetup"]={paperSize:9,orientation:"portrait",scale:100,fitToWidth:1,fitToHeight:0,margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3}};const n=s.utils.book_new();s.utils.book_append_sheet(n,t,"FormattedReport"),s.writeFile(n,`${p}_${(i==null?void 0:i.applicantName)||"details"}.xlsx`)},x=()=>{const h=document.getElementById(m);if(!h){alert("Report Table Not Found");return}const t=s.utils.table_to_sheet(h,{raw:!0}),l=s.utils.sheet_to_csv(t,{FS:",",RS:`
`,strip:!0}),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(u),n=document.createElement("a");n.href=b,n.setAttribute("download",`${p}_${(i==null?void 0:i.applicantName)||"data"}.csv`),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(b)};return d.jsx("div",{children:d.jsxs("div",{className:"flex justify-end gap-4 my-4 px-4",children:[d.jsx("button",{onClick:()=>window.print(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Print / Save as PDF"}),d.jsx("button",{onClick:f,className:"bg-teal-600 text-white px-4 py-2 rounded hover:bg-teal-700",children:"Export to Excel"}),d.jsx("button",{onClick:x,className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Export to CSV"})]})})};export{_ as F};
