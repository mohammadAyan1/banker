import{i as le,a1 as ie,h as u,a as oe,cC as se,j as e,S as ae}from"./index-w41rB-zE.js";import{u as c,a as ne}from"./xlsx-x9ZxUr7s.js";import"./xlsx.min-CNgOfykx.js";import{T as ce}from"./index-CcXi3yHa.js";import{C as l}from"./index-BfqrA0XI.js";import{D as t}from"./index-CojmTsVD.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-CMUBo7h7.js";import"./isVisible-DhUEo0yb.js";import"./styleChecker-Dr9BUc6D.js";import"./index-DDhR-cup.js";import"./roundedArrow-DSsJecMi.js";import"./compact-item-CeLi5kmI.js";import"./TextArea-B63JDhoP.js";import"./CloseCircleFilled-DZvUHeBU.js";import"./useVariants-Dhb08RNU.js";import"./EllipsisOutlined-DjOyNqyA.js";import"./PlusOutlined-C-itGNEv.js";import"./useBreakpoint-C8nH0e-V.js";import"./useForceUpdate-DbKdcjNo.js";const{Title:de}=ce,Fe=()=>{var p;const d=le(),{id:n}=ie(),r=u(i=>i.dmiFinance.report),x=u(i=>i.dmiFinance.loading),m=i=>{const o=Object.entries({Branch:r.branch,"Application Number":r.applicationNumber,"Applicant Name":r.applicantName,Product:r.product,"Property Type":r.propertyType,"Report Date":r.reportDate,"Date of Visit":r.dateOfVisit,"Visited By":r.visitedBy,"Property Address As Per Site":r.propertyAddressAsPerSite,"Property Address As Per Documents":r.propertyAddressAsPerDocuments,"House No":r.houseNo,"Floor No":r.floorNo,"Wing Name/No":r.wingNameNo,"Colony/Project Name":r.colonyProjectName,"Khasra/Survey No":r.khasraSurveyNo,"Sector/Phase/Ward":r.sectorPhaseWard,"Mauza/Police Station":r.mauzaPoliceStation,"Village/Location":r.villageLocation,District:r.district,State:r.state,"City/Tehsil/Taluka/Town":r.cityTehsilTalukaTown,Pincode:r.pincode,"Distance from Nearest DMI Branch":r.distanceFromNearestDmiBranch,"Distance from City Centre":r.distanceFromNearestCityCentre,"Distance from Landmark":r.distanceFromLandmark,"Documents Submitted":r.listOfDocumentsSubmitted,"Property Owner":r.propertyOwnerAsPerDocuments,"If No, Who Owns":r.ifNoWhoOwnsTheProperty,"Person Met":r.nameOfPersonMet,"Contact of Person Met":r.contactNoOfPersonMet,"Relation With Applicant":r.relationWithApplicant,"Contact of Applicant":r.contactNoOfApplicant,"Locality Development":r.localityDevelopment,"Special Remarks":r.specialRemarks,"Report Status":r.reportStatus,"Prepared By":r.name}).map(([te,re])=>({Field:te,Value:re})),ee=c.json_to_sheet(o),h=c.book_new();c.book_append_sheet(h,ee,"Report"),ne(h,`DMI_Formatted_Report${i==="csv"?".csv":".xlsx"}`)},{branch:j,applicationNumber:b,applicantName:y,product:N,propertyType:P,reportDate:D,dateOfVisit:f,visitedBy:I,propertyAddressAsPerSite:S,propertyAddressAsPerDocuments:A,houseNo:g,floorNo:w,wingNameNo:v,colonyProjectName:k,khasraSurveyNo:C,sectorPhaseWard:T,mauzaPoliceStation:F,villageLocation:O,district:R,state:M,cityTehsilTalukaTown:B,pincode:W,distanceFromNearestDmiBranch:L,distanceFromNearestCityCentre:V,distanceFromLandmark:_,listOfDocumentsSubmitted:E,propertyOwnerAsPerDocuments:z,ifNoWhoOwnsTheProperty:H,nameOfPersonMet:K,contactNoOfPersonMet:J,relationWithApplicant:U,contactNoOfApplicant:$,localityDevelopment:q,specialRemarks:G,reportStatus:Q,name:X,_id:Y,__v:Z,valuation:s,documents:a}=r||{};return oe.useEffect(()=>{n&&d(se(n))},[n,d]),x||!r?e.jsx(ae,{className:"flex justify-center mt-10",size:"large"}):e.jsxs("div",{className:"p-6 space-y-6 bg-gray-100 ",id:"print-section",children:[e.jsx(de,{level:3,className:"text-center",children:"Full Property Valuation Report"}),e.jsxs("div",{className:"flex justify-end gap-4 my-4",children:[e.jsx("button",{onClick:()=>window.print(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Print / Save as PDF"}),e.jsx("button",{onClick:()=>m("excel"),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Export to Excel"}),e.jsx("button",{onClick:()=>m("csv"),className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Export to CSV"})]}),e.jsxs("div",{className:"",id:"reportTable",children:[e.jsx(l,{title:"Applicant & Loan Details",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"Branch",children:j}),e.jsx(t.Item,{label:"Application Number",children:b}),e.jsx(t.Item,{label:"Applicant Name",children:y}),e.jsx(t.Item,{label:"Product",children:N})]})}),e.jsx(l,{title:"Property Basic Details",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"Property Type",children:P}),e.jsx(t.Item,{label:"Report Date",children:D}),e.jsx(t.Item,{label:"Date of Visit",children:f}),e.jsx(t.Item,{label:"Visited By",children:I})]})}),e.jsx(l,{title:"Property Address Details",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"Address As Per Site",children:S}),e.jsx(t.Item,{label:"Address As Per Documents",children:A}),e.jsx(t.Item,{label:"House No",children:g}),e.jsx(t.Item,{label:"Floor No",children:w}),e.jsx(t.Item,{label:"Wing Name/No",children:v}),e.jsx(t.Item,{label:"Colony/Project Name",children:k}),e.jsx(t.Item,{label:"Khasra/Survey No",children:C}),e.jsx(t.Item,{label:"Sector/Phase/Ward",children:T}),e.jsx(t.Item,{label:"Mauza/Police Station",children:F}),e.jsx(t.Item,{label:"Village/Location",children:O}),e.jsx(t.Item,{label:"District",children:R}),e.jsx(t.Item,{label:"State",children:M}),e.jsx(t.Item,{label:"City/Tehsil/Taluka/Town",children:B}),e.jsx(t.Item,{label:"Pincode",children:W})]})}),e.jsx(l,{title:"Distance Details",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"From Nearest DMI Branch",children:L}),e.jsx(t.Item,{label:"From Nearest City Centre",children:V}),e.jsx(t.Item,{label:"From Landmark",children:_})]})}),e.jsx(l,{title:"Document & Ownership Details",bordered:!0,children:e.jsxs(t,{column:1,children:[e.jsx(t.Item,{label:"List of Documents Submitted",children:E}),e.jsx(t.Item,{label:"Property Owner As Per Documents",children:z}),e.jsx(t.Item,{label:"If No, Who Owns The Property",children:H||"N/A"})]})}),e.jsx(l,{title:"Person Met at Property",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"Name of Person Met",children:K}),e.jsx(t.Item,{label:"Contact No of Person Met",children:J}),e.jsx(t.Item,{label:"Relation With Applicant",children:U}),e.jsx(t.Item,{label:"Contact No of Applicant",children:$})]})}),e.jsx(l,{title:"Locality and Special Remarks",bordered:!0,children:e.jsxs(t,{column:1,children:[e.jsx(t.Item,{label:"Locality Development",children:q}),e.jsx(t.Item,{label:"Special Remarks",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:G})})]})}),e.jsx(l,{title:"Report Summary",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"Report Status",children:Q}),e.jsx(t.Item,{label:"Report Prepared By",children:X})]})}),e.jsx(l,{title:"System Metadata (For Debug)",bordered:!0,children:e.jsxs(t,{column:2,children:[e.jsx(t.Item,{label:"MongoDB ID",children:Y}),e.jsx(t.Item,{label:"Version",children:Z})]})}),e.jsx(l,{title:"Valuation Particulars (if any)",bordered:!0,children:((p=s==null?void 0:s.particulars)==null?void 0:p.length)>0?e.jsx("ul",{className:"list-disc pl-6",children:s.particulars.map((i,o)=>e.jsx("li",{children:JSON.stringify(i)},o))}):e.jsx("p",{children:"No particulars available."})}),e.jsx(l,{title:"Uploaded Documents",bordered:!0,children:(a==null?void 0:a.length)>0?e.jsx("ul",{className:"list-disc pl-6",children:a.map((i,o)=>e.jsx("li",{children:i},o))}):e.jsx("p",{children:"No documents uploaded."})})]})]})};export{Fe as default};
